/* esri-leaflet-heatmap-feature-layer - v2.0.0-beta.1 - Fri Aug 07 2015 11:36:12 GMT-0700 (PDT)
 * Copyright (c) 2015 Environmental Systems Research Institute, Inc.
 * Apache 2.0 */
(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports,require("leaflet"),require("esri-leaflet")):typeof define==="function"&&define.amd?define(["exports","leaflet","esri-leaflet"],factory):factory(global.L.esri.Heat={},L,L.esri)})(this,function(exports,L,esri_leaflet){"use strict";exports.VERSION="2.0.0-beta.1";exports.HeatmapFeatureLayer=esri_leaflet.FeatureManager.extend({initialize:function(options){esri_leaflet.FeatureManager.prototype.initialize.call(this,options);options=L.setOptions(this,options);this._cache={};this._active={};this.heat=window.L.heatLayer([],options)},onAdd:function(map){esri_leaflet.FeatureManager.prototype.onAdd.call(this,map);this._map.addLayer(this.heat)},onRemove:function(map){esri_leaflet.FeatureManager.prototype.onRemove.call(this,map);this._map.removeLayer(this.heat)},createLayers:function(features){for(var i=features.length-1;i>=0;i--){var geojson=features[i];var id=geojson.id;var latlng=new L.LatLng(geojson.geometry.coordinates[1],geojson.geometry.coordinates[0]);this._cache[id]=latlng;if(!this._active[id]&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(geojson))){this._active[id]=latlng;this.heat._latlngs.push(latlng)}}this.heat.redraw()},addLayers:function(ids){for(var i=ids.length-1;i>=0;i--){var id=ids[i];if(!this._active[id]){var latlng=this._cache[id];this.heat._latlngs.push(latlng);this._active[id]=latlng}}this.heat.redraw()},removeLayers:function(ids,permanent){var newLatLngs=[];for(var i=ids.length-1;i>=0;i--){var id=ids[i];if(this._active[id]){delete this._active[id]}if(this._cache[id]&&permanent){delete this._cache[id]}}for(var latlng in this._active){newLatLngs.push(this._active[latlng])}this.heat.setLatLngs(newLatLngs)}});function heatmapFeatureLayer(options){return new exports.HeatmapFeatureLayer(options)}var _HeatmapFeatureLayer=heatmapFeatureLayer;exports.heatmapFeatureLayer=heatmapFeatureLayer;exports.default=_HeatmapFeatureLayer});
//# sourceMappingURL=./esri-leaflet-heatmap-feature-layer.js.map